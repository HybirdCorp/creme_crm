{% extends "creme_core/generics/view_entity.html" %}
{% load i18n %}
{% load creme_core_tags %}

{% block entity_buttons %}
    {% if can_download %}
        <a href="/billing/generate_pdf/{{object.id}}" onclick="creme._export.select_one(event, this);">
            <img src="{% creme_media_url 'images/download_64.png' %}" title="{% blocktrans %}Download '{{object}}' to the desired format{% endblocktrans %}" alt="{% blocktrans %}Download '{{object}}' to the desired format{% endblocktrans %}" />
        </a>
    {% endif %}
    {{block.super}}
{% endblock %}

{% block extrahead %}
    {{block.super}}
    <script type='text/javascript'>
        $(document).ready(function() {
            $(window).bind('beforeunload', creme.billing.checkModifiedOnUnload);
            creme.billing.initBlockLines('{{ object.currency.local_symbol }}');
        });
    </script>
{% endblock %}

{% block extra_menu_buttons %}
    <li>{% has_perm_to change object as change_perm %}{% trans "Save all lines" as verbose_name %}
        {% if change_perm %}
            <a class="menu_button" onclick="creme.billing.multi_save_lines('{{object.pk}}');return false;">
                <img src="{% creme_media_url 'images/ok_22.png' %}" border="0" title="{{verbose_name}}" alt="{{verbose_name}}" />
                {{verbose_name}}
            </a>
        {% else %}
            <span class="menu_button forbidden" title="{% trans "forbidden" %}">
                <img src="{% creme_media_url 'images/ok_22.png' %}" border="0" title="{{verbose_name}}" alt="{{verbose_name}}" />
                {{verbose_name}}
            </span>
        {% endif %}
    </li>
{% endblock %}
